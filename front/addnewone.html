<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<link type="text/css" rel="stylesheet" href="style/reset.css" >
		<link rel="stylesheet" type="text/css" href="style/main.css">
		<link rel="stylesheet" type="text/css" href="style/style.css">
		<script type="text/javascript" src="js/jquery-2.1.4.js"></script>
		<script type="text/javascript" src="js/js.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>添加商品</title>
		<!-- basic styles -->

		<link href="style/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="style/font-awesome.min.css" />

		<!-- page specific plugin styles -->
		<link rel="stylesheet" href="style/dropzone.css" />
		<link rel="stylesheet" href="style/jquery-ui-1.10.3.full.min.css" />
		<link rel="stylesheet" href="style/datepicker.css" />
		<link rel="stylesheet" href="style/ui.jqgrid.css" />
		<link rel="stylesheet" href="style/jquery-ui-1.10.3.custom.min.css" />
		<link rel="stylesheet" href="style/chosen.css" />
		<link rel="stylesheet" href="style/datepicker.css" />
		<link rel="stylesheet" href="style/bootstrap-timepicker.css" />
		<link rel="stylesheet" href="style/daterangepicker.css" />
		<link rel="stylesheet" href="style/colorpicker.css" />

		<!-- fonts -->

		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" />

		<!-- ace styles -->

		<link rel="stylesheet" href="style/ace.min.css" />
		<link rel="stylesheet" href="style/ace-rtl.min.css" />
		<link rel="stylesheet" href="style/ace-skins.min.css" />

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->

		<script src="js/ace-extra.min.js"></script>

	</head>

	<body>
		<div id="header">
			<div class="topbar">
				<div class="comWidth2">
					<ul class="leftArea">
						<li>
							<a href="index.html">玫瑰网：二手玫瑰，手有余香</a>
						</li>
						<li>
							<span class="sep">|</span>
						</li>
						<li>
							<a href="#">关于我们</a>
						</li>
						<li>
							<span class="sep">|</span>
						</li>
						<li>
							<a href="#">问题反馈</a>
						</li>
						
					</ul>
					
				</div>
			</div>
		</div>

		<div class="row">
		<div class="col-xs-12">
			<!-- PAGE CONTENT BEGINS -->

			<form class="form-horizontal" name="addnewForm" id="form1" role="form">
				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 商品名称 </label>

					<div class="col-sm-9">
						<input type="text" id="form-field-1" class="col-xs-10 col-sm-5"  name="title" />
					</div>
				</div>

				<div class="space-4"></div>

				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right" for="form-field-2"> 单价 </label>
					<div class="col-sm-9">
						<input type="text" id="form-field-2" class="col-xs-10 col-sm-5" name="price"/>
						
					</div>
				</div>

				<div class="space-4"></div>

				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right" for="form-field-3"> 库存量 </label>
					<div class="col-sm-9">
						<input type="text" id="form-field-3" class="col-xs-10 col-sm-5"  name="overplus"/>
						
					</div>
				</div>
				<div class="space-4"></div>

				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right" for="form-field-4" >商品描述</label>
					<div class="col-sm-9">
						<input type="text" id="form-field-4" class="col-xs-10 col-sm-5" name="intro"/>
						
					</div>
				</div>

				<div class="col-xs-12 col-sm-6" style = "position:relative;left:400px;top:0px">
					<div class="control-group">
						<label class="control-label bolder blue">类别</label>

						<div class="radio">
							<label>
								<input name="type" type="radio" class="ace" />
								<span class="lbl"> 服装</span>
							</label>
						</div>

						<div class="radio">
							<label>
								<input name="type" type="radio" class="ace" />
								<span class="lbl"> 电子设备</span>
							</label>
						</div>

						<div class="radio">
							<label>
								<input name="type" type="radio" class="ace" />
								<span class="lbl"> 家具</span>
							</label>
						</div>
					</div>
				</div>
				<div class="space-4"></div>

				<div class="form-group">
					<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" for="form-field-5"></label>
						<div class="col-sm-9">
							<input name="file" id="form-field-5" class="col-xs-10 col-sm-5" type="file" multiple="" />
						</div>
					</div>
				</div>
				<div class="space-4"></div>
				
				</form>

				<div class="clearfix form-actions">
					<div class="col-md-offset-3 col-md-9">
						<button class="addnew btn btn-info" type="button" onclick="addnew()">
							<i class="icon-ok bigger-110"></i>
							确认
						</button>

						&nbsp; &nbsp; &nbsp;
						<button class="btn" type="reset">
							<i class="icon-undo bigger-110"></i>
							重置
						</button>
					</div>
				</div>
				
				<div class="hr hr-24"></div>
			
		</div>
	</div>
	<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
	</script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/typeahead-bs2.min.js"></script>

	<!-- page specific plugin scripts -->

	<script src="js/dropzone.min.js"></script>

	<!-- ace scripts -->

	<script src="js/ace-elements.min.js"></script>
	<script src="js/ace.min.js"></script>

	<!-- inline scripts related to this page -->

	<script type="text/javascript">
		jQuery(function($){
		
		try {
		  $(".dropzone").dropzone({
		    paramName: "file", // The name that will be used to transfer the file
		    maxFilesize: 0.5, // MB
		  
			addRemoveLinks : true,
			dictDefaultMessage :
			'<span class="bigger-150 bolder"><i class="icon-caret-right red"></i> Drop files</span> to upload \
			<span class="smaller-80 grey">(or click)</span> <br /> \
			<i class="upload-icon icon-cloud-upload blue icon-3x"></i>'
		,
			dictResponseError: 'Error while uploading file!',
			
			//change the previewTemplate to use Bootstrap progress bars
			previewTemplate: "<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-details\">\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n    <div class=\"dz-size\" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class=\"progress progress-small progress-striped active\"><div class=\"progress-bar progress-bar-success\" data-dz-uploadprogress></div></div>\n  <div class=\"dz-success-mark\"><span></span></div>\n  <div class=\"dz-error-mark\"><span></span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n</div>"
		  });
		} catch(e) {
		  alert('Dropzone.js does not support older browsers!');
		}
		
		});

		function addnew(){
			var title=document.addnewForm.title.value;
			var price=document.addnewForm.price.value;
			var overplus=document.addnewForm.overplus.value;
			var intro=document.addnewForm.intro.value;
			console.log(document.addnewForm.file.files[0])
			
			var radios=document.getElementsByName("type");
			var type;
			for (var i = 0; i < radios.length; i++) {
				if (radios[i].checked==true) {
					if(i==0){
						type="衣";
					}
					else if(i==1){
						type="电";
					}
					else if(i==2){
						type="家";
					}
			    }
			}

			if(title.length==0||price.length==0||overplus.length==0||intro.length==0||type==null||type==undefined){
				alert("请输入或选中！")
				return false;
			}
			
			
            var fileObj=new FormData();
            fileObj.append("title",title);
            fileObj.append("price",price);
            fileObj.append("vol",overplus);
            fileObj.append("intro",intro);
            fileObj.append("type",type);

            fileObj.append("file",document.addnewForm.file.files[0]);
            if(sessionStorage.uid!=null&&sessionStorage.uid!=undefined){
            	fileObj.append("userId",sessionStorage.uid);
            }

	        $.ajax({  
	            url: 'http://111.230.233.124/market/index.php/Home/Goods/addGoods?userId='+sessionStorage.uid,  
	            type: 'POST',  
	            data: fileObj,  
	            dataType: 'JSON',  
	            cache: false,  
	            processData: false,  
	            contentType: false  
	        }).done(function(data){ 
	        	console.log(data)
	        	window.location.href="jqgrid.html"

	        });  
	        return true;  

		}





	</script>

</body>
</html>
